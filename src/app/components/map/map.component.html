<mat-tab-group (selectedIndexChange)="tabSwitched($event)">
  <mat-tab label="Table">
    <mat-card>
      <mat-card-title>Instructions</mat-card-title>
      <mat-card-content>
        <p>
          Symbols inputs a StraboSpot xls file of structural data from field stations and outputs a Google Earth KML
          file with
          inclined orientation symbols.
        </p>
        <button type="button" mat-raised-button (click)="fileInput.click()">Choose File</button>
        <input hidden #fileInput type="file" #fileImportInput (change)="fileChangeListener($event)">
      </mat-card-content>
    </mat-card>
    <mat-card *ngIf="csvRecords.data.length">
      <mat-card-title>Export to KML</mat-card-title>
      <mat-card-content>

        <h3>Setting for export</h3>
        <mat-form-field class="form-f">
          <mat-label>Symbol length [m]</mat-label>
          <input matInput type="number" min="5" max="100" step="5" [(ngModel)]="kmlOptions.symbolLength">
        </mat-form-field>
        <mat-form-field class="form-f">
          <mat-label>Symbol height [m]</mat-label>
          <input matInput type="number" min="5" max="100" step="5" [(ngModel)]="kmlOptions.symbolHeight">
        </mat-form-field>
        <mat-form-field class="form-f">
          <mat-label>Symbol line thickness</mat-label>
          <input matInput type="number" min="1" max="20" step="1" [(ngModel)]="kmlOptions.lineWidth">
        </mat-form-field>
        <mat-form-field class="form-f">
          <mat-label>Filename</mat-label>
          <input matInput [(ngModel)]="kmlOptions.documentName">
        </mat-form-field>
        <mat-form-field class="form-f" appearance="none">
          <mat-slide-toggle [(ngModel)]="kmlOptions.useAltitude">Use altitude column</mat-slide-toggle>
          <textarea matInput hidden></textarea>
        </mat-form-field>
        <mat-form-field class="form-f" *ngIf="kmlOptions.useAltitude">
          <mat-label>Google Elevation API key</mat-label>
          <input matInput [(ngModel)]="kmlOptions.googleMapsElevationApi">
        </mat-form-field>
        <mat-divider></mat-divider>

        <h3>Group symbols to folders by</h3>
        <mat-form-field class="form-f" appearance="none">
          <mat-slide-toggle [(ngModel)]="kmlOptions.groupTags">Unit/Formation</mat-slide-toggle>
          <textarea matInput hidden></textarea>
        </mat-form-field>
        <mat-form-field class="form-f" appearance="none">
          <mat-slide-toggle [(ngModel)]="kmlOptions.groupGeometry">Location</mat-slide-toggle>
          <textarea matInput hidden></textarea>
        </mat-form-field>
        <mat-divider></mat-divider>

        <h3>Tag Colors</h3>
        <mat-form-field *ngFor="let item of csvRecords.tagColors" appearance="fill">
          <mat-label>{{item.tag}}</mat-label>
          <input matInput [value]="item.color" style="padding:5px 0" [style.background]="item.color"
            [cpAlphaChannel]="'disabled'" [cpOutputFormat]="'hex'" [(colorPicker)]="item.color" />
        </mat-form-field>
      </mat-card-content>
      <mat-card-actions>
        <button mat-button color="primary" (click)="export()">Export</button>
      </mat-card-actions>
    </mat-card>
    <mat-card *ngIf="csvRecords.data.length">
      <mat-card-content>
        <mat-chip-list>
          <mat-chip color="primary" selected>Total Rows {{csvRecords.data.length}}</mat-chip>
          <mat-chip *ngIf="(csvRecords.data.length - cleanEmptyElements().length) !== 0" color="warn" selected
            (click)="autoRemoveEmptyElements()">
            <mat-icon aria-hidden="false" aria-label="Example home icon">highlight_off</mat-icon>
            Invalid Rows {{csvRecords.data.length - cleanEmptyElements().length}}
          </mat-chip>
        </mat-chip-list>
      </mat-card-content>
      <p>
        <b>Cell text color for selected headers: </b>
        <span style="color: gray;">probably ok</span>,
        <span style="color: red;">invalid</span>,
        <span style="color: green;">OK</span>
      </p>
      <div style="overflow-x: auto; margin: 10px -16px -16px -16px;">
        <table>
          <thead>
            <tr>
              <th></th>
              <th *ngFor="let item of ' '.repeat(csvRecords.data[0].length).split(''); index as colIndex">
                <button (click)="removeColumn(colIndex)" mat-icon-button color="warn">
                  <mat-icon aria-hidden="false" aria-label="Example home icon">delete</mat-icon>
                </button>
              </th>
            </tr>
            <tr>
              <th></th>
              <th *ngFor="let item of ' '.repeat(csvRecords.data[0].length).split(''); index as colIndex">
                <mat-select [(ngModel)]="csvRecords.headerOrder[colIndex]">
                  <mat-option [value]="hIndex" *ngFor="let item of csvRecords.headerNames; index as hIndex">
                    {{item}}
                  </mat-option>
                </mat-select>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of csvRecords.data; index as rowIndex" [class]="invalidRow(row)?'':'invalid'">
              <td>
                <button (click)="removeRow(rowIndex)" mat-icon-button color="warn">
                  <mat-icon aria-hidden="false" aria-label="Example home icon">delete</mat-icon>
                </button>
              </td>
              <td *ngFor="let column of row; index as colIndex" [style.color]="validateCell(column, colIndex)">
                {{column}}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </mat-card>
    <mat-card>
      <mat-card-content>
        Developed by Mladen Dordevic (IRIS) and Steve Whitmeyer (JMU) <br> ver:{{version.version}} build:{{version.raw}}
      </mat-card-content>
    </mat-card>
  </mat-tab>
  <mat-tab label="Map">
    <p *ngIf="selected" style="position: absolute;top: 0px;z-index: 999;background: #dedede;    padding: 5px;">
      Strike <input type="text" [(ngModel)]="strike">
      Dip <input type="text" [(ngModel)]="dip">
      <button (click)="update()">Update</button>
    </p>
    <div #map id="map"></div>
  </mat-tab>
</mat-tab-group>
